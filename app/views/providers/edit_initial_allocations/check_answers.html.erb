<% page_title = "Check your information before sending your request" %>
<% content_for :page_title, page_title %>

<% content_for :before_content do %>
  <%= govuk_back_link_to(
    get_edit_initial_request_provider_recruitment_cycle_allocation_path(
      provider.provider_code,
      recruitment_cycle.year,
      training_provider.provider_code,
      number_of_places: params[:number_of_places],
      request_type: params[:request_type],
      next_step: "number_of_places",
      id: allocation.id,
    ),
  ) %>
<% end %>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <%= form_with(
      model: form_object,
      url: update_initial_request_provider_recruitment_cycle_allocation_path(
        provider.provider_code,
        recruitment_cycle.year,
        training_provider.provider_code,
        id: allocation.id,
      ),
      scope: "",
      skip_enforcing_utf8: true,
      builder: GOVUKDesignSystemFormBuilder::FormBuilder,
    ) do |f| %>

      <h1 class="govuk-heading-l">
        <span class="govuk-caption-l"><%= training_provider.provider_name %></span>
        <%= page_title %>
      </h1>

      <%= govuk_summary_list do |summary_list| %>
        <% summary_list.slot(
          :row,
          key: "Places requested",
          value: params[:number_of_places],
          action: change_link_to(
            "places requested",
            get_edit_initial_request_provider_recruitment_cycle_allocation_path(
              provider.provider_code,
              recruitment_cycle.year,
              training_provider.provider_code,
              number_of_places: params[:number_of_places],
              request_type: params[:request_type],
              next_step: "number_of_places",
              id: allocation.id,
            ),
          ),
        ) %>
      <% end %>

      <%= hidden_field_tag "number_of_places", params[:number_of_places] %>
      <%= hidden_field_tag "request_type", params[:request_type] %>
      <%= hidden_field_tag "finish_flow", "1" %>

      <%= f.govuk_submit "Send request", data: { qa: "allocations__send_request" } %>
    <% end %>
  </div>
</div>
